define(["jquery","base/view"],function(a,b){"use strict";var c;return c=b.extend({props:{defaultOptions:{autoStart:!0,mask:"{hour}:{min}:{sec}"},templates:{main:"app_catalog/tmpl/countdown"}},public:{init:function(){return this.endTime=new Date(this.options.time),this.render(),this.options.autoStart&&this.start(),this},destroy:function(){return c.__super__.destroy.call(this),clearInterval(this.interval),this},start:function(){return null!==this.interval&&clearInterval(this.interval),this.update(),this.interval=setInterval(this.update.bind(this),1e3),this},stop:function(){return clearInterval(this.interval),this.interval=null,this},resume:function(a){return a?this.endTime=a:this.endTime=(new Date).getTime()+1e3*this.offset.total,this.start(),this},update:function(){var a=(new Date).getTime(),b=this.endTime-a;return b=Math.ceil(b/1e3),b>=0?(this.offset={total:b,sec:b%60,min:Math.floor(b/60)%60},this.options.mask.indexOf("day")>0?(this.offset.hour=Math.floor(b/60/60)%24,this.offset.day=Math.floor(b/60/60/24)):this.offset.hour=Math.floor(b/60/60)):(this.stop(),this.trigger("end")),this.$el.html(this.getTimeString(this.offset,this.options.mask)),this},isRun:function(){return!!this.interval},getEndTime:function(){return this.endTime},getTimeString:function(a,b){var c,d,e=b;for(c in a)a.hasOwnProperty(c)&&(d=a[c],d<10&&(d="0"+d),e=e.replace("{"+c+"}",d));return e}}})});